{% include "baseadmin.html.twig" %}
{% block body %}
	<div style="display: flex; ">
		<div class="d-flex flex-column vh-100 flex-shrink-0 p-3 text-white classPerso" style="width: 250px;">
			<ul class="nav nav-pills flex-column mb-auto">
				<li class="nav-item d-flex align-items-center mb-3 mb-md-0 me-md-auto text-white text-decoration-none"></li>
				<li>
					<a href="{{ path('admin_stats_customer') }}" class="nav-link text-white active">
						<i class="fa fa-dashboard"></i>
						<span class="ms-2">Statistiques clients</span>
					</a>
				</li>
				<li>
					<a href="{{ path('admin_stats_services') }}" class="nav-link text-white">
						<i class="fa fa-first-order"></i>
						<span class="ms-2">Statistiques services</span>
					</a>
				</li>
				<li>
					<a href="{{ path('admin_gestion_produit') }}" class="nav-link  text-white">
						<i class="fa fa-cog"></i>
						<span class="ms-2">Gestion des produits</span>
					</a>
				</li>
				<li>
					<a href="{{ path('admin_gestion_services') }}" class="nav-link text-white">
						<i class="fa fa-cog"></i>
						<span class="ms-2">Gestion des services</span>
					</a>
				</li>
				<li>
					<a href="{{ path('admin_gestion_devis') }}" class="nav-link text-white">
						<i class="fa fa-bookmark"></i>
						<span class="ms-2">Gestion des devis</span>
					</a>
				</li>
				<hr>
				<li>
					<a href="/logout" class="nav-link text-white">
						<i class="fa fa-bookmark"></i>
						<span class="ms-2">Déconnexion</span>
					</a>
				</li>
			</ul>
		</div>
		<div class="container">
			<pre>
			{{ dump(statUsers) }}
		</pre>
			<h2>Nombre d'utilisateurs :
				{{ users|length }}</h2>
			<canvas id="statU" width="auto" height="auto"></canvas>
			<h2>Nombre de vente/mois :
				{{ orders|length }}</h2>
				<canvas id="statO" width="auto" height="auto"></canvas>
			<h2>Bénefice de cette année</h2>
		</div>

	</div>
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	<script>
		function r(max) {
return Math.floor(Math.random() * max);
}
function rColor() {
return 'rgb(' + r(255) + ',' + r(255) + ',' + r(255) + ')'
}
const ctxU = document.getElementById('statU').getContext('2d');

let labels=[]
let data=[]
let bgColor=[]
let bdColor=[]
{% for stat in statUsers %}
	labels.push('{{ stat['dateCreate']|date('Y-m-d') }}')
	data.push('{{ stat['nb'] }}')
{% endfor %}
for(let i = 0; i < labels.length; i++){
	bgColor.push(rColor())
	bdColor.push(rColor())
}
const uChart = new Chart(ctxU, {
    type: 'line',
    data: {
        labels: labels,
        datasets: [{
            label: 'Création de compte',
            data: data,
            backgroundColor: bgColor,
            borderColor: bdColor,
            borderWidth: 1
        }]
    },
    options: {
        scales: {
            y: {
                beginAtZero: true
            }
        }
    }
});
const ctxO = document.getElementById('statO').getContext('2d');
const oChart = new Chart(ctxO, {
    type: 'bar',
    data: {
        labels: labels,
        datasets: [{
            label: 'Création de compte',
            data: data,
            backgroundColor: bgColor,
            borderColor: bdColor,
            borderWidth: 1
        }]
    },
    options: {
        scales: {
            y: {
                beginAtZero: true
            }
        }
    }
});
	</script>
{% endblock %}
